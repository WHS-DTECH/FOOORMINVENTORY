{% extends "base.html" %}
{% block content %}
<div style="width:100%; display:flex; justify-content:flex-end; margin-bottom:1em;">
  <form method="get" action="/parser_debug_raw/{{ test_recipe_id }}" style="margin:0;">
    <button type="submit" class="btn btn-outline-secondary" style="font-size:1em;">View Raw Data</button>
  </form>
</div>
<div style="display: flex; gap: 2em;">
  <div style="flex: 1;">
    <h3>Raw Data (HTML/Text)</h3>
    <div style="display: flex;">
      <div style="background: #f0f0f0; color: #888; padding: 1em 0.5em 1em 1em; border: 1px solid #ccc; border-right: none; text-align: right; user-select: none; font-family: monospace;">
        {% set lines = (raw_data or raw_title or '') .split('\n') %}
        {% for i in range(1, lines|length + 1) %}
          <div style="min-width: 2.5em;">{{ i }}</div>
        {% endfor %}
      </div>
      <pre style="max-height: 600px; overflow: auto; background: #f8f8f8; border: 1px solid #ccc; border-left: none; padding: 1em; margin: 0; flex: 1;">{% for line in lines %}{{ line|e }}
{% endfor %}</pre>
    </div>
  </div>
  <div style="flex: 1;">
    <h3>Title Extraction Strategies</h3>
    <table class="table table-bordered">
      <thead><tr><th>Strategy</th><th>Result</th></tr></thead>
      <tbody>
        {% for strat in strategies %}
        <tr{% if strat.best %} style="background: #d0f5d0;"{% endif %}>
          <td>{{ strat.name }}</td>
          <td>{{ strat.value }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <h4>Best Guess:</h4>
    <div style="font-size: 1.2em; font-weight: bold; color: #0074d9;">{{ best_guess }}</div>
  </div>
</div>
{% endblock %}
